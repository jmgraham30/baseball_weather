---
title: "Open-Air Baseball Parks"
subtitle: "The Impacts of Weather Conditions"
author: "Jason M. Graham"
institute: "University of Scranton"
format: 
  html:
    code-fold: true
    echo: true
bibliography: report_bib.bib
---

```{r}
#| echo: false
#| include: false

# load packages
library(tidyverse) # wrangling, plots etc.
library(GGally) # paired plots
library(skimr) # data summary

# set plot theme
theme_set(theme_minimal(base_size = 12))

venues_html <- "https://raw.githubusercontent.com/jmgraham30/baseball_weather/main/data/USProSportsVenues.csv"

bos_game_weather_html <- "https://raw.githubusercontent.com/jmgraham30/baseball_weather/main/data/boston_game_weather.csv"

```


```{r}
#| message: false

# load weather and game data for Boston 
bos_game_weather_df <- read_csv(bos_game_weather_html)
# load sports venue data
pro_sports_venues <- read_csv(venues_html)
# extract baseball parks
baseball_parks <- pro_sports_venues %>%
  filter(Sport == "MLB")

# add info about open roof
baseball_parks$Open_Roof <- c("No",rep("Yes",9),
                              "No","Yes","Yes","Yes",
                              "No","No",
                              rep("Yes",7),"No","Yes",
                              "Yes","No","No","No","Yes")

# load map data for US states minus AK and HI
states_df <- map_data("state") %>%
  filter(region != "alaska" | region != "hawaii")
```

## Executive Summary


## Background

[Major League Baseball](https://en.wikipedia.org/wiki/Major_League_Baseball) (MLB) is a professional athletics organization made up 30 baseball teams, 29 in the United States and one in Canada, [view MLB homepage](https://www.mlb.com/). Each of the thirty Major League Baseball teams plays in one of thirty stadiums or baseball parks [@wikipediaListCurrent]. A list of the thirty MLB stadiums can be found on Wikipedia, [go to Wikipedia article on MLB stadiums](https://en.wikipedia.org/wiki/List_of_current_Major_League_Baseball_stadiums). Of the thirty MLB baseball stadiums, 22 of them are open-air. [^1] @fig-parks shows a map of the MLB stadiums and uses color to designate the open-air status of each of the stadiums. 

[^1]: By "open-air" we mean permanently open with no option for roof cover. Stadiums with either a fixed or retractable roof are not considered to be open-air for our purposes. 

```{r}
#| label: fig-parks
#| fig-cap: The 30 MLB park locations and their open-air status. Darker shading indicates overlap of nearby parks. 
#| fig-alt: A plot showing the location of each of the 30 MLB stadiums by its latitude and longitude overlayed on a map of the 48 continental United States. Colors are used to distinguish the open-air status of each of the stadiums, 22 of the 30 stadiums are designated as open-air.

ggplot() +
  geom_polygon(data=states_df,
               aes(long,lat,group=group),
               fill="white",color="darkgrey") + 
  geom_point(data=baseball_parks,aes(x=Longitude,y=Latitude,color=Open_Roof),
             size=2.5,alpha=0.5) +
  scale_color_manual(values=c("orange","darkblue")) + 
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5)) + 
  xlab("") + ylab("") + ggtitle("Major League Baseball Parks")
```

### Initial Research Question

We would like to know about the impact that climate or weather may have on MLB teams that play in open-air stadiums. Given that climate and weather patterns are changing and impacting many aspects of our society and lives, and given that many MLB parks are exposed to the elements for many months of the year, it could be that changing climate and weather conditions may impact MLB. In particular, we would like to know if changing climate and weather patterns might have an effect on either team performance or game attendance. 

### Approach to Research

In order to address our initial research question, we will take as a case study the open-air stadium [Fenway Park](https://en.wikipedia.org/wiki/Fenway_Park), home of the [Boston Red Sox](https://en.wikipedia.org/wiki/Boston_Red_Sox), [view Red Sox homepage](https://www.mlb.com/redsox). Fenway park in located in Boston, Massachusetts (42°20′46.5″N 71°5′51.9″W) and is the oldest MLB park, open since 1912 [@wikipediaFenwayPark], [see the Fenway homepage](https://www.mlb.com/redsox/ballpark). @fig-fenway shows a view of Fenway Park, image from [@ticketmasterStepInside]. @fig-parks-fenway shows the same map of MLB stadiums as @fig-parks but with Fenway Park highlighted. 


![Feway Park, image from [@ticketmasterStepInside]](https://blog.ticketmaster.com/wp-content/uploads/Fenway-Park-field.jpg){#fig-fenway width=70%}



```{r}
#| label: fig-parks-fenway
#| fig-cap: MLB park locations and open-air status with Fenway Park in Boston, MA highlighted.

ggplot() +
  geom_polygon(data=states_df,
               aes(long,lat,group=group),
               fill="white",color="darkgrey") + 
  geom_point(data=baseball_parks,aes(x=Longitude,y=Latitude,color=Open_Roof),
             size=2.5,alpha=0.5) +
  geom_point(data=baseball_parks %>% filter(Abbreviation == "BOS"),
                                            aes(x=Longitude,y=Latitude),size=5,color="darkblue") + 
  geom_label( 
    data=baseball_parks %>% filter(Abbreviation == "BOS"), # Filter data first
    aes(label="Fenway",x=-71,y=43.6),color = "black",
    fill="red") + 
  scale_color_manual(values=c("orange","darkblue")) + 
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        axis.ticks.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.y = element_blank(),
        axis.text.y = element_blank(),
        plot.title = element_text(hjust = 0.5)) + 
  xlab("") + ylab("") + ggtitle("Major League Baseball Parks (Fenway Highlighted)")
```

The main part of this project combines data about home games played at Fenway Park with historical Boston area weather data in an attempt to assess if changing climate and weather conditions have impacted either team performance or park attendance at Fenway, with Fenway serving as an example of an open-air baseball stadium. 

## Data Collection and Documentation

### Team Data



### Weather Data


## Exploratory Results



## Models



## Model Results



## Conclusions



## References

::: {#refs}
:::


:::{.callout-tip collapse="true"}
## Expand for Session Info
```{r}
#| echo: false


library(sessioninfo)
# save the session info as an object
pkg_sesh <- session_info(pkgs = "attached")

# get the quarto version
quarto_version <- system("quarto --version", intern = TRUE)

# inject the quarto info
pkg_sesh$platform$quarto <- paste(
  system("quarto --version", intern = TRUE), 
  "@", 
  quarto::quarto_path()
  )

# print it out
pkg_sesh
```

:::